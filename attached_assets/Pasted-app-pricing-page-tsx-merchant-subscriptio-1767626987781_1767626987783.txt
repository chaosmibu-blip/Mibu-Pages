app/
├── pricing/
│   └── page.tsx                    // 訂閱方案頁
├── merchant/
│   ├── subscription/
│   │   ├── page.tsx                // 訂閱管理頁
│   │   ├── success/page.tsx        // 付款成功頁
│   │   └── cancel/page.tsx         // 付款取消頁
components/
├── pricing/
│   ├── PricingCard.tsx             // 方案卡片
│   ├── PaymentMethodSelector.tsx   // 支付方式選擇
│   └── CheckoutButton.tsx          // 結帳按鈕
1. 訂閱方案頁 UI
// app/pricing/page.tsx
export default function PricingPage() {
  return (
    <div className="min-h-screen bg-gray-50 py-16">
      <div className="max-w-5xl mx-auto px-4">
        <h1 className="text-4xl font-bold text-center">商家訂閱方案</h1>
        <p className="text-gray-600 text-center mt-4">
          選擇適合您的方案，提升曝光、吸引更多旅客
        </p>
        {/* 方案卡片區 */}
        <div className="grid md:grid-cols-3 gap-8 mt-12">
          {/* Free 方案 */}
          <PricingCard
            title="Free"
            price={0}
            period="永久免費"
            features={['1 間店家', '5 張優惠券', '基礎數據報表']}
            buttonText="目前方案"
            disabled
          />
          {/* Pro 方案 */}
          <PricingCard
            title="Pro"
            price={299}
            period="/月"
            features={['3 間店家', '20 張優惠券', '進階數據報表', '優先曝光']}
            buttonText="升級 Pro"
            highlighted
            onSelect={() => handleSelectPlan('pro')}
          />
          {/* Premium 方案 */}
          <PricingCard
            title="Premium"
            price={799}
            period="/月"
            features={['無限店家', '無限優惠券', '完整數據報表', '最高優先曝光', '專屬客服']}
            buttonText="升級 Premium"
            onSelect={() => handleSelectPlan('premium')}
          />
        </div>
      </div>
    </div>
  );
}
2. 方案卡片組件 UI
// components/pricing/PricingCard.tsx
interface PricingCardProps {
  title: string;
  price: number;
  period: string;
  features: string[];
  buttonText: string;
  highlighted?: boolean;
  disabled?: boolean;
  onSelect?: () => void;
}
export function PricingCard({ 
  title, price, period, features, buttonText, highlighted, disabled, onSelect 
}: PricingCardProps) {
  return (
    <div className={`
      rounded-2xl p-8 
      ${highlighted 
        ? 'bg-primary text-white ring-4 ring-primary/30 scale-105' 
        : 'bg-white shadow-lg'
      }
    `}>
      <h3 className="text-2xl font-bold">{title}</h3>
      
      <div className="mt-4">
        <span className="text-4xl font-bold">NT${price}</span>
        <span className={highlighted ? 'text-white/80' : 'text-gray-500'}>
          {period}
        </span>
      </div>
      <ul className="mt-6 space-y-3">
        {features.map((feature, i) => (
          <li key={i} className="flex items-center gap-2">
            <CheckIcon className={`w-5 h-5 ${highlighted ? 'text-white' : 'text-green-500'}`} />
            <span>{feature}</span>
          </li>
        ))}
      </ul>
      <button
        onClick={onSelect}
        disabled={disabled}
        className={`
          w-full mt-8 py-3 rounded-xl font-semibold transition
          ${highlighted 
            ? 'bg-white text-primary hover:bg-gray-100' 
            : 'bg-primary text-white hover:bg-primary/90'
          }
          ${disabled ? 'opacity-50 cursor-not-allowed' : ''}
        `}
      >
        {buttonText}
      </button>
    </div>
  );
}
3. 支付方式選擇彈窗 UI
// components/pricing/PaymentMethodSelector.tsx
interface PaymentMethodSelectorProps {
  isOpen: boolean;
  onClose: () => void;
  tier: 'pro' | 'premium';
  onConfirm: (provider: 'stripe' | 'recur') => void;
}
export function PaymentMethodSelector({ isOpen, onClose, tier, onConfirm }: PaymentMethodSelectorProps) {
  const [provider, setProvider] = useState<'stripe' | 'recur'>('recur');
  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="max-w-md">
        <DialogHeader>
          <DialogTitle>選擇付款方式</DialogTitle>
        </DialogHeader>
        <div className="space-y-4 py-4">
          {/* Recur 選項 */}
          <label className={`
            flex items-center gap-4 p-4 rounded-xl border-2 cursor-pointer transition
            ${provider === 'recur' ? 'border-primary bg-primary/5' : 'border-gray-200'}
          `}>
            <input
              type="radio"
              name="provider"
              checked={provider === 'recur'}
              onChange={() => setProvider('recur')}
              className="w-5 h-5 text-primary"
            />
            <div className="flex-1">
              <div className="font-semibold">台灣本地支付</div>
              <div className="text-sm text-gray-500">信用卡、ATM 轉帳</div>
            </div>
            <img src="/recur-logo.svg" alt="Recur" className="h-6" />
          </label>
          {/* Stripe 選項 */}
          <label className={`
            flex items-center gap-4 p-4 rounded-xl border-2 cursor-pointer transition
            ${provider === 'stripe' ? 'border-primary bg-primary/5' : 'border-gray-200'}
          `}>
            <input
              type="radio"
              name="provider"
              checked={provider === 'stripe'}
              onChange={() => setProvider('stripe')}
              className="w-5 h-5 text-primary"
            />
            <div className="flex-1">
              <div className="font-semibold">國際信用卡</div>
              <div className="text-sm text-gray-500">Visa, Mastercard, AMEX</div>
            </div>
            <img src="/stripe-logo.svg" alt="Stripe" className="h-6" />
          </label>
        </div>
        <DialogFooter>
          <Button variant="outline" onClick={onClose}>取消</Button>
          <Button onClick={() => onConfirm(provider)}>
            前往付款
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}
4. 結帳邏輯
// hooks/useCheckout.ts
export function useCheckout() {
  const [loading, setLoading] = useState(false);
  const checkout = async (tier: 'pro' | 'premium', provider: 'stripe' | 'recur') => {
    setLoading(true);
    try {
      const res = await fetch('/api/merchant/subscription/checkout', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ type: 'merchant', tier, provider }),
      });
      const data = await res.json();
      if (provider === 'stripe') {
        // Stripe: 直接跳轉
        window.location.href = data.url;
      } else {
        // Recur: 使用 SDK
        const recur = window.RecurCheckout.init({ 
          publishableKey: data.publishableKey 
        });
        await recur.redirectToCheckout({
          productId: data.productId,
          externalCustomerId: data.externalCustomerId,
          successUrl: data.successUrl,
          cancelUrl: data.cancelUrl,
        });
      }
    } catch (error) {
      toast.error('結帳失敗，請稍後再試');
    } finally {
      setLoading(false);
    }
  };
  return { checkout, loading };
}
5. 付款成功頁 UI
// app/merchant/subscription/success/page.tsx
export default function SubscriptionSuccessPage() {
  const searchParams = useSearchParams();
  const tier = searchParams.get('tier');
  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50">
      <div className="max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center">
        <div className="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto">
          <CheckCircleIcon className="w-10 h-10 text-green-600" />
        </div>
        
        <h1 className="text-2xl font-bold mt-6">訂閱成功！</h1>
        <p className="text-gray-600 mt-2">
          您已成功升級至 {tier?.toUpperCase()} 方案
        </p>
        <div className="bg-gray-50 rounded-xl p-4 mt-6">
          <p className="text-sm text-gray-500">新權限已立即生效</p>
          <ul className="text-left mt-3 space-y-2">
            <li className="flex items-center gap-2 text-sm">
              <CheckIcon className="w-4 h-4 text-green-500" />
              更多店家名額
            </li>
            <li className="flex items-center gap-2 text-sm">
              <CheckIcon className="w-4 h-4 text-green-500" />
              更多優惠券額度
            </li>
          </ul>
        </div>
        <Link 
          href="/merchant/dashboard" 
          className="inline-block mt-6 px-6 py-3 bg-primary text-white rounded-xl font-semibold"
        >
          前往商家後台
        </Link>
      </div>
    </div>
  );
}
6. 訂閱管理頁 UI
// app/merchant/subscription/page.tsx
export default function SubscriptionManagePage() {
  const { data } = useMerchantSubscription();
  return (
    <div className="max-w-2xl mx-auto p-6">
      <h1 className="text-2xl font-bold">訂閱管理</h1>
      {/* 當前方案 */}
      <div className="mt-6 bg-white rounded-2xl shadow p-6">
        <div className="flex justify-between items-start">
          <div>
            <span className="text-sm text-gray-500">目前方案</span>
            <h2 className="text-xl font-bold mt-1">
              {data?.tier?.toUpperCase() || 'FREE'}
            </h2>
          </div>
          <span className={`
            px-3 py-1 rounded-full text-sm font-medium
            ${data?.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}
          `}>
            {data?.status === 'active' ? '使用中' : '已過期'}
          </span>
        </div>
        {data?.currentPeriodEnd && (
          <p className="text-sm text-gray-500 mt-4">
            下次扣款日：{format(new Date(data.currentPeriodEnd), 'yyyy/MM/dd')}
          </p>
        )}
        <div className="flex gap-4 mt-6">
          <Link href="/pricing" className="flex-1 py-2 text-center border rounded-lg">
            變更方案
          </Link>
          {data?.tier !== 'free' && (
            <button 
              onClick={handleCancel}
              className="flex-1 py-2 text-center text-red-600 border border-red-200 rounded-lg"
            >
              取消訂閱
            </button>
          )}
        </div>
      </div>
      {/* 訂閱歷史 */}
      <div className="mt-8">
        <h3 className="font-semibold mb-4">訂閱歷史</h3>
        <div className="space-y-3">
          {data?.history?.map((item) => (
            <div key={item.id} className="bg-white rounded-lg p-4 flex justify-between">
              <div>
                <span className="font-medium">{item.tier.toUpperCase()}</span>
                <span className="text-gray-500 text-sm ml-2">
                  {format(new Date(item.createdAt), 'yyyy/MM/dd')}
                </span>
              </div>
              <span className={`text-sm ${
                item.status === 'active' ? 'text-green-600' : 'text-gray-400'
              }`}>
                {item.status}
              </span>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}
三、Recur SDK 載入（官網）
<!-- 在 layout.tsx 或 _document.tsx 中 -->
<script src="https://unpkg.com/recur-tw@0.11.0/dist/recur.umd.js"></script>
或使用 npm：

npm install recur-tw