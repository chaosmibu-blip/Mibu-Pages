# CLAUDE.md

> **è§’è‰²å®šä½**ï¼šæœ¬å°ˆæ¡ˆæ˜¯**å¥‘ç´„åŸ·è¡Œè€…**ï¼Œä¾ç…§å¾Œç«¯å¥‘ç´„å¯¦ä½œå®˜ç¶²åŠŸèƒ½ã€‚å¾Œç«¯æ˜¯å”¯ä¸€çœŸç›¸ä¾†æºï¼Œå®˜ç¶²ä¸å¯è‡ªè¡Œå®šç¾© API æˆ–å‹åˆ¥ã€‚

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

---

## å¿«é€Ÿè·¯ç”±è¡¨ ğŸš€

é‡åˆ°é—œéµå­—æ™‚ï¼Œç›´æ¥æŸ¥é–±å°æ‡‰æ–‡ä»¶ï¼š

| é—œéµå­— | æŸ¥é–±æ–‡ä»¶ |
|--------|----------|
| ç™»å…¥ã€OAuthã€èªè­‰ã€E1006ã€E1007 | `docs/memory-merchant-portal.md` |
| è¨‚é–±ã€é‡‘æµã€Stripeã€Recurã€é€€æ¬¾ | `docs/memory-merchant-portal.md` |
| SEOã€åŸå¸‚ã€æ™¯é»ã€è¡Œç¨‹ã€Metadata | `docs/memory-seo-pages.md` |
| å…ƒä»¶ã€UIã€Buttonã€Cardã€AuthGuard | `docs/memory-components.md` |
| API å‹åˆ¥ã€ç«¯é»æ ¼å¼ | å¾Œç«¯ `docs/contracts/WEB.md` |
| éŒ¯èª¤ç¢¼ã€E1xxx~E9xxx | å¾Œç«¯ `docs/contracts/COMMON.md` |
| åŒæ­¥æŒ‡ä»¤ã€å¾…è¾¦ä»»å‹™ | å¾Œç«¯ `docs/sync-web.md` |
| å·²å®Œæˆä»»å‹™ã€å›å ±ç‹€æ…‹ | `docs/sync-backend.md` |

---

## æºé€šé¢¨æ ¼

- ç”¨å£èªåŒ–çš„ç¹é«”ä¸­æ–‡
- åƒæœ‹å‹èŠå¤©ä¸€æ¨£è§£é‡‹
- å°ˆæœ‰åè©è¦é †ä¾¿èªªæ˜ç™½è©±æ„æ€
- ä¿®æ”¹å‰å…ˆèªªã€Œæˆ‘æƒ³åšä»€éº¼ã€å’Œã€Œç‚ºä»€éº¼ã€

---

## åº•ç·šè¦å‰‡ ğŸš«

### å®‰å…¨åº•ç·š

| ç¦æ­¢äº‹é … | åŸå›  |
|----------|------|
| åœ¨ç¨‹å¼ç¢¼ä¸­ç¡¬ç·¨ç¢¼ API keysã€tokens | æœƒè¢« git è¿½è¹¤ï¼Œé€ æˆæ´©æ¼ |
| ç¹é AuthGuard å­˜å–å•†å®¶é é¢ | ç ´å£èªè­‰æ©Ÿåˆ¶ |
| åœ¨å‰ç«¯å„²å­˜æ•æ„Ÿè³‡æ–™ï¼ˆå¯†ç¢¼ã€ä¿¡ç”¨å¡ï¼‰ | å‰ç«¯ä¸å®‰å…¨ |
| è‡ªè¡Œå¯¦ä½œ OAuth æµç¨‹ | æ‡‰ä½¿ç”¨ç¾æœ‰çš„ Google/Apple SDK |

### æ¥­å‹™åº•ç·š

| ç¦æ­¢äº‹é … | åŸå›  |
|----------|------|
| è‡ªè¡Œå®šç¾© API å‹åˆ¥ | å¿…é ˆä¾ç…§å¾Œç«¯å¥‘ç´„ |
| ä¿®æ”¹é‡‘æµé‚è¼¯ï¼ˆStripe/Recurï¼‰ | å½±éŸ¿ä»˜æ¬¾æ­£ç¢ºæ€§ |
| æ›´æ”¹é€€æ¬¾è¦å‰‡ï¼ˆ7 å¤©å…§ï¼‰ | æ¶‰åŠæ¶ˆä¿æ³•è¦å®š |
| åˆªé™¤æˆ–ä¿®æ”¹ SEO metadata æ ¼å¼ | å½±éŸ¿æœå°‹æ’å |

### ç¦æ­¢ä¿®æ”¹çš„æª”æ¡ˆ

| æª”æ¡ˆ | åŸå›  |
|------|------|
| `shared/schema.ts` | Drizzle ORM schemaï¼Œæ”¹å‹•å½±éŸ¿è³‡æ–™åº« |
| `.npmrc` | npm èªè­‰è¨­å®š |
| `next.config.ts` | é™¤éæ˜ç¢ºéœ€è¦èª¿æ•´ Next.js è¨­å®š |

---

## API å¥‘ç´„è¦å‰‡ âš¡

**å¾Œç«¯æ˜¯å”¯ä¸€çœŸç›¸ä¾†æº**ï¼Œå®˜ç¶²å¿…é ˆä¾ç…§å¾Œç«¯å¥‘ç´„å¯¦ä½œã€‚

### å¥‘ç´„ä½ç½®

```
å¾Œç«¯ (MIBU_REPLIT)
â””â”€â”€ docs/contracts/
    â”œâ”€â”€ COMMON.md    â† èªè­‰ã€éŒ¯èª¤ç¢¼ã€å…±ç”¨å‹åˆ¥
    â””â”€â”€ WEB.md       â† å®˜ç¶²å°ˆç”¨ API
```

### åŒæ­¥è¦å‰‡

1. **å®˜ç¶²ä¸å¯è‡ªè¡Œå®šç¾© API å‹åˆ¥** - å¿…é ˆä¾ç…§å¥‘ç´„
2. **ç™¼ç¾ä¸ä¸€è‡´æ™‚** - å›å ±å¾Œç«¯ä¿®æ­£å¥‘ç´„ï¼Œè€Œéè‡ªè¡Œä¿®æ”¹å®˜ç¶²
3. **å¾Œç«¯æ”¹å¥‘ç´„å¾Œ** - å®˜ç¶²éœ€åŒæ­¥æ›´æ–°

### å¿«é€ŸæŒ‡ä»¤

| æŒ‡ä»¤ | èªªæ˜ |
|------|------|
| ã€ŒåŒæ­¥å®˜ç¶²èˆ‡ WEB å¥‘ç´„ã€ | è®€å–å¾Œç«¯å¥‘ç´„ï¼Œæ›´æ–°å®˜ç¶²å‹åˆ¥å®šç¾© |
| ã€Œå¯©è¨ˆæ¶æ§‹ä¸€è‡´æ€§ã€ | æ¯”å°å®˜ç¶²èˆ‡å¾Œç«¯çš„ API å·®ç•° |
| ã€ŒåŒæ­¥å°ˆæ¡ˆè¨˜æ†¶ã€ | æ›´æ–° CLAUDE.md ç¢ºä¿èˆ‡ç¾æ³ä¸€è‡´ |
| ã€Œæª¢æŸ¥å¾Œç«¯åŒæ­¥æ¸…å–®ã€ | è®€å– `docs/sync-web.md` åŸ·è¡ŒåŒæ­¥æŒ‡ä»¤ |
| ã€Œå¯«è¨ˆç•«ã€ | é€²å…¥ Plan Modeï¼Œé‡å°ç•¶å‰ä»»å‹™å¯«å®Œæ•´è¨ˆç•«æ–‡ä»¶å¾Œå†åŸ·è¡Œ |
| ã€ŒSEO æ¼”é€²æª¢æŸ¥ã€ | æª¢æŸ¥å¾Œç«¯/App æ–°åŠŸèƒ½ï¼ŒåŒæ­¥æ›´æ–°å®˜ç¶²çµæ§‹åŒ–è³‡æ–™ï¼ˆè¦‹ä¸‹æ–¹ SEO æ¼”é€²æµç¨‹ï¼‰ |
| ã€ŒSEO æ„åœ–çŸ©é™£ã€ | åˆ†æèªæ„è¦†è“‹ç¼ºå£ã€å…§éƒ¨é€£çµç¶²çµ¡ã€ä¸»é¡Œæ¬Šå¨é£›è¼ªï¼ˆè¦‹ä¸‹æ–¹ SEO æ„åœ–çŸ©é™£æ“´å±•ï¼‰ |

---

## ä¸‰ç«¯å”ä½œ ğŸ”—

Mibu ç”¢å“ç”±ä¸‰å€‹ç¨ç«‹å°ˆæ¡ˆçµ„æˆï¼Œå¾Œç«¯æ˜¯å”¯ä¸€çœŸç›¸ä¾†æºã€‚

### å°ˆæ¡ˆå€‰åº«

| å°ˆæ¡ˆ | å€‰åº« | è·è²¬ |
|------|------|------|
| **å¾Œç«¯** | [MIBU_REPLIT](https://github.com/chaosmibu-blip/MIBU_REPLIT) | APIã€è³‡æ–™åº«ã€å¥‘ç´„åˆ¶å®š |
| **APP** | [mibu-app](https://github.com/chaosmibu-blip/mibu-app) | æ‰­è›‹ã€è¡Œç¨‹è¦åŠƒã€æ”¶è— |
| **å®˜ç¶²** | [Mibu-Pages](https://github.com/chaosmibu-blip/Mibu-Pages) | SEOã€å•†å®¶è¨‚é–± |

### åŒæ­¥æ©Ÿåˆ¶

```
å¾Œç«¯å®Œæˆ API è®Šæ›´
    â†“
æ›´æ–° docs/contracts/*.mdï¼ˆå¥‘ç´„ï¼‰
    â†“
æ›´æ–° docs/sync-web.md æˆ– docs/sync-app.mdï¼ˆåŒæ­¥æŒ‡ä»¤ï¼‰
    â†“
å®˜ç¶²/APP è®€å–åŒæ­¥æŒ‡ä»¤ä¸¦åŸ·è¡Œ
    â†“
å›å ±å®Œæˆç‹€æ…‹åˆ° docs/sync-backend.md
```

### å”ä½œè¦ç¯„

- **å¥‘ç´„ä½ç½®**: å¾Œç«¯ `docs/contracts/`
- **åŒæ­¥æŒ‡ä»¤**: å¾Œç«¯ `docs/sync-web.md`ï¼ˆå®˜ç¶²ç”¨ï¼‰
- **å®Œæˆå›å ±**: å®˜ç¶² `docs/sync-backend.md`

---

## Project Overview

**Mibu-Pages æ˜¯ Mibu æ—…éŠæ‰­è›‹ App çš„å®˜æ–¹ç¶²ç«™**ï¼Œä¸æ˜¯ App æœ¬èº«ã€‚

æœå‹™å…©é¡ç”¨æˆ¶ï¼š
- **ä¸€èˆ¬æ—…å®¢**ï¼šé€é SEO é é¢è®“ Google æœå°‹ã€Œæ™¯é»ã€ã€Œè¡Œç¨‹ã€æ™‚èƒ½æ‰¾åˆ° Mibuï¼Œå¼•å°ä¸‹è¼‰ App
- **å•†å®¶**ï¼šè³¼è²·è¨‚é–±æ–¹æ¡ˆï¼ˆiOS è¦å®šè·¨å¹³å°è¨‚é–±å¿…é ˆåœ¨å®˜ç¶²å®Œæˆï¼‰

### æœ¬å°ˆæ¡ˆè² è²¬ï¼š
- å“ç‰Œå®£å‚³é¦–é ï¼ˆå¼•å°ä¸‹è¼‰ Appï¼‰
- SEO å…¬é–‹é é¢ï¼ˆåŸå¸‚ã€æ™¯é»ã€è¡Œç¨‹ï¼Œä¾›æœå°‹å¼•æ“ç´¢å¼•ï¼‰
- å•†å®¶å¾Œå°ï¼ˆç™»éŒ„ã€è¨‚é–±è³¼è²·ã€æŸ¥çœ‹è¨‚é–±ã€å–æ¶ˆè¨‚é–±ã€ç”³è«‹é€€æ¬¾ï¼‰
- æ³•å¾‹é é¢ï¼ˆéš±ç§æ”¿ç­–ã€æœå‹™æ¢æ¬¾ã€é€€æ¬¾æ”¿ç­–ï¼‰
- å®¢æœæ”¯æ´è¡¨å–®

### æœ¬å°ˆæ¡ˆä¸è² è²¬ï¼š
- æ‰­è›‹æ ¸å¿ƒåŠŸèƒ½ï¼ˆåœ¨ App å…§ï¼‰
- ç”¨æˆ¶è¨»å†Š/ç™»éŒ„ï¼ˆApp è™•ç†ï¼‰
- æ—…ç¨‹è¦åŠƒæ“ä½œï¼ˆApp è™•ç†ï¼‰
- å•†å®¶è¨»å†Šã€åº—å®¶èªé ˜ã€æ•¸æ“šå ±è¡¨ï¼ˆåƒ…åœ¨ App ä¸­æä¾›ï¼‰

## æŠ€è¡“æ£§

- **æ¡†æ¶**: Next.js 15 (App Router)
- **æ¨£å¼**: Tailwind CSS 3.x + shadcn/ui
- **è³‡æ–™**: TanStack Query 5.x
- **è¡¨å–®**: React Hook Form + Zod
- **ç‹€æ…‹ç®¡ç†**: Zustand + persistï¼ˆlocalStorageï¼‰
- **èªè­‰**: Google/Apple OAuth
- **é‡‘æµ**: Stripe/Recur é›™è»Œ

## Commands

```bash
npm run dev          # é–‹ç™¼æ¨¡å¼ï¼ˆtsx server/index.ts å•Ÿå‹• Next.jsï¼‰
npm run build        # å»ºç½®ç”Ÿç”¢ç‰ˆæœ¬
npm run start        # å•Ÿå‹•ç”Ÿç”¢ä¼ºæœå™¨
npm run check        # TypeScript å‹åˆ¥æª¢æŸ¥
npm run db:push      # æ¨é€ schema åˆ°è³‡æ–™åº«
```

## å°ˆæ¡ˆçµæ§‹

```
app/                    # Next.js App Router é é¢
â”œâ”€â”€ page.tsx            # é¦–é  + ä¸‹è¼‰æŒ‰éˆ•
â”œâ”€â”€ explore/            # åŸå¸‚åˆ—è¡¨é 
â”œâ”€â”€ city/[slug]/        # åŸå¸‚è©³æƒ…é  (SSG + ISR)
â”œâ”€â”€ place/[id]/         # æ™¯é»è©³æƒ…é  (SSG + ISR)
â”œâ”€â”€ trips/              # è¡Œç¨‹åˆ—è¡¨é  (SSG + ISR)
â”œâ”€â”€ trips/[city]/       # åŸå¸‚è¡Œç¨‹é  (SSG + ISR)
â”œâ”€â”€ trips/[city]/[district]/ # å€åŸŸè¡Œç¨‹é  (SSG + ISR)
â”œâ”€â”€ trip/[id]/          # è¡Œç¨‹è©³æƒ…é  (SSG + ISR)
â”œâ”€â”€ crowdfund/          # å‹Ÿè³‡ç³»çµ±ï¼ˆWEB v1.2.0 æ–°å¢ï¼‰
â”‚   â”œâ”€â”€ page.tsx        # å‹Ÿè³‡æ´»å‹•åˆ—è¡¨
â”‚   â”œâ”€â”€ [id]/           # å‹Ÿè³‡è©³æƒ… + è´ŠåŠ©
â”‚   â””â”€â”€ my-contributions/ # æˆ‘çš„è´ŠåŠ©ç´€éŒ„
â”œâ”€â”€ for-business/       # å•†å®¶åˆä½œé é¢
â”œâ”€â”€ merchant/           # å•†å®¶ç™»å…¥/å¾Œå°
â”‚   â”œâ”€â”€ login/          # å•†å®¶ç™»å…¥ï¼ˆGoogle/Apple OAuthï¼‰
â”‚   â”œâ”€â”€ dashboard/      # å„€è¡¨æ¿
â”‚   â”œâ”€â”€ places/         # æ™¯é»ç®¡ç†ï¼ˆPhase 6 æ›´æ–°ï¼‰
â”‚   â”‚   â””â”€â”€ new/        # æ–°å¢æ™¯é»é é¢ï¼ˆ#005ï¼‰
â”‚   â”œâ”€â”€ subscribe/      # çµå¸³é é¢
â”‚   â””â”€â”€ subscription/   # æˆ‘çš„è¨‚é–±ï¼ˆå”¯è®€ï¼‰
â”œâ”€â”€ privacy/            # éš±ç§æ¬Šæ”¿ç­–
â”œâ”€â”€ terms/              # æœå‹™æ¢æ¬¾
â”œâ”€â”€ refund/             # é€€æ¬¾èˆ‡å–æ¶ˆæ”¿ç­–
â”œâ”€â”€ support/            # æŠ€è¡“æ”¯æ´
â”œâ”€â”€ sitemap.ts          # å‹•æ…‹ sitemap
â””â”€â”€ robots.ts           # robots.txt

src/
â”œâ”€â”€ constants/
â”‚   â””â”€â”€ errorCodes.ts   # éŒ¯èª¤ç¢¼å¸¸æ•¸ï¼ˆä¾ç…§ COMMON å¥‘ç´„ï¼‰
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ seo/            # SEO æ¨¡çµ„åŒ–æ¶æ§‹ï¼ˆç¨‹å¼åŒ– SEO ç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ api/        # API è³‡æ–™ç²å–å±¤ï¼ˆä¾ç…§ WEB å¥‘ç´„ï¼‰
â”‚   â”‚   â”œâ”€â”€ metadata/   # Metadata ç”¢ç”Ÿå™¨
â”‚   â”‚   â”œâ”€â”€ jsonLd/     # JSON-LD çµæ§‹åŒ–è³‡æ–™ç”¢ç”Ÿå™¨
â”‚   â”‚   â”œâ”€â”€ components/ # SEO å°ˆç”¨çµ„ä»¶ï¼ˆBreadcrumb, JsonLdScriptï¼‰
â”‚   â”‚   â””â”€â”€ types/      # å‹åˆ¥å®šç¾©ï¼ˆä¾ç…§ WEB å¥‘ç´„ï¼‰
â”‚   â”œâ”€â”€ crowdfund/      # å‹Ÿè³‡ç³»çµ±æ¨¡çµ„ï¼ˆWEB v1.2.0 æ–°å¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ api/        # API å±¤
â”‚   â”‚   â””â”€â”€ types/      # å‹åˆ¥å®šç¾©
â”‚   â””â”€â”€ events/         # æ´»å‹•ç³»çµ±æ¨¡çµ„ï¼ˆ#006ï¼‰
â”‚       â”œâ”€â”€ api/        # API å±¤ï¼ˆgetEvents, getActiveEventsï¼‰
â”‚       â”œâ”€â”€ types/      # å‹åˆ¥å®šç¾©ï¼ˆEvent, EventTypeï¼‰
â”‚       â””â”€â”€ components/ # çµ„ä»¶ï¼ˆEventsSectionï¼‰
â”œâ”€â”€ services/
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ index.ts    # é€šç”¨ API è«‹æ±‚è™•ç†
â”‚       â””â”€â”€ merchant.ts # å•†å®¶ APIï¼ˆä¾ç…§ WEB å¥‘ç´„ v1.2.0ï¼‰
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/             # shadcn/ui å…ƒä»¶
â”‚   â”œâ”€â”€ layout/         # Header, Footer
â”‚   â”œâ”€â”€ common/         # é€šç”¨æ¥­å‹™å…ƒä»¶
â”‚   â””â”€â”€ auth/           # AuthGuard
â”œâ”€â”€ hooks/              # useAuth, useRefundEligibility, useRefundRequest ç­‰
â””â”€â”€ lib/                # å·¥å…·å‡½æ•¸

server/
â”œâ”€â”€ index.ts            # å•Ÿå‹• Next.js é€²ç¨‹
â””â”€â”€ routes.ts           # API ç«¯é»ï¼ˆmock è³‡æ–™ï¼‰

shared/
â””â”€â”€ schema.ts           # Drizzle ORM schema + Zod validation
```

> **æ³¨æ„**: `client/` ç›®éŒ„æ˜¯èˆŠçš„ Vite + React SPA ä»£ç¢¼ï¼Œå·²é·ç§»è‡³ Next.jsï¼Œä¸å†ä½¿ç”¨ã€‚

## é é¢è¦æ ¼

### SEO é é¢ï¼ˆé¢å‘æ—…å®¢ï¼‰
| è·¯ç”± | æ¸²æŸ“æ–¹å¼ |
|------|----------|
| `/` | SSG + ISR (5min) |
| `/explore` | SSG + ISR (1hr) |
| `/city/[slug]` | SSG + ISR (1hr) |
| `/place/[id]` | SSG + ISR (1hr) |
| `/trips` | SSG + ISR (1hr) |
| `/trips/[city]` | SSG + ISR (1hr) |
| `/trips/[city]/[district]` | SSG + ISR (1hr) |
| `/trip/[id]` | SSG + ISR (1hr) |

### å•†å®¶é é¢
| è·¯ç”± | æ¸²æŸ“æ–¹å¼ |
|------|----------|
| `/for-business` | éœæ…‹ |
| `/for-business/pricing` | CSR |
| `/merchant/login` | CSR |
| `/merchant/places` | CSR (éœ€èªè­‰) |
| `/merchant/places/new` | CSR (éœ€èªè­‰) |
| `/merchant/subscription` | CSR (éœ€èªè­‰) |
| `/merchant/subscribe` | CSR (éœ€èªè­‰) |

## èªè­‰ç³»çµ±

- **ç‹€æ…‹ç®¡ç†**: Zustand + persistï¼ˆlocalStorageï¼‰
- **Store**: `src/hooks/useAuth.ts`
- **ä¿è­·å…ƒä»¶**: `src/components/auth/AuthGuard.tsx`
- **ç™»å…¥å…ƒä»¶**: `src/components/common/SocialLoginButtons.tsx`
- **éŒ¯èª¤ä»£ç¢¼**ï¼ˆä¾ç…§ COMMON å¥‘ç´„ï¼‰:
  - `E1006` (PENDING_APPROVAL): å¸³è™Ÿå¯©æ ¸ä¸­
  - `E1007` (ROLE_MISMATCH): å¸³è™Ÿéå•†å®¶é¡å‹

## å•†å®¶åŠŸèƒ½ç¯„åœï¼ˆå®˜ç¶²é™å®šï¼‰

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| ç™»å…¥ | Google/Apple OAuthï¼Œéå•†å®¶å¸³è™Ÿé¡¯ç¤ºéŒ¯èª¤å¼•å°ä¸‹è¼‰ App |
| æ™¯é»ç®¡ç† | èªé ˜å·²æœ‰æ™¯é»æˆ–æ–°å¢è‡ªæœ‰æ™¯é»ï¼ˆéœ€å¯©æ ¸ï¼‰ |
| æ–°å¢æ™¯é» | å¡«å¯«åŸºæœ¬è³‡è¨Šã€è¯çµ¡æ–¹å¼ã€ç‡Ÿæ¥­æ™‚é–“ï¼Œæäº¤å¯©æ ¸ |
| è¨‚é–±è³¼è²· | é¸æ“‡æ–¹æ¡ˆ â†’ ç™»å…¥ â†’ çµå¸³ï¼ˆStripe/Recur é›™è»Œé‡‘æµï¼‰ |
| æŸ¥çœ‹è¨‚é–± | é¡¯ç¤ºæ–¹æ¡ˆã€ç‹€æ…‹ã€åˆ°æœŸæ—¥ã€é…é¡ |
| å–æ¶ˆè¨‚é–± | åœ¨è¨‚é–±ç®¡ç†é é¢é»æ“Šå–æ¶ˆï¼Œæœå‹™æŒçºŒè‡³ç•¶æœŸçµæŸ |
| ç”³è«‹é€€æ¬¾ | é¦–æ¬¡ä»˜æ¬¾ 7 å¤©å…§å¯ç”³è«‹ï¼Œç¬¦åˆæ¶ˆä¿æ³•è¦å®š |

### å•†å®¶ç­‰ç´šï¼ˆä¾ç…§ WEB å¥‘ç´„ï¼‰

```typescript
type MerchantLevel = 'free' | 'pro' | 'premium' | 'partner';
```

## é‡‘æµä¸²æ¥

| é‡‘æµå•† | ä¸²æ¥æ–¹å¼ | å›æ‡‰æ ¼å¼ |
|--------|----------|----------|
| **Stripe** | Checkout Session | `{ checkoutUrl }` |
| **Recur** | SDK `redirectToCheckout` | `{ productId, publishableKey }` |

## ä¸‹è¼‰æŒ‰éˆ•è¦æ ¼

- **iOS**ï¼šè·³è½‰ App Store
- **Android**ï¼šToast é¡¯ç¤ºã€Œæ•¬è«‹æœŸå¾…ã€

## Environment Variables

```env
NEXT_PUBLIC_API_URL=å¾Œç«¯ API URL
NEXT_PUBLIC_GOOGLE_CLIENT_ID=Google OAuth Client ID
NEXT_PUBLIC_APPLE_CLIENT_ID=Apple Sign In Client ID
NEXT_PUBLIC_RECUR_PUBLISHABLE_KEY=Recur å…¬é–‹é‡‘é‘°
DATABASE_URL=PostgreSQL é€£ç·šå­—ä¸²
BASE_URL=ç¶²ç«™åŸºç¤ URLï¼ˆé è¨­ https://mibu-travel.comï¼‰
```

## å¾Œç«¯ API

| ç’°å¢ƒ | URL |
|------|-----|
| é–‹ç™¼ | `https://591965a7-25f6-479c-b527-3890b1193c21-00-1m08cwv9a4rev.picard.replit.dev` |
| ç”Ÿç”¢ | `https://gacha-travel--s8869420.replit.app` |

## è·¯å¾‘åˆ¥å

```
@/*            â†’ ./src/*
@/features/*   â†’ ./src/features/*
@/components/* â†’ ./src/components/*
@/lib/*        â†’ ./src/lib/*
@/hooks/*      â†’ ./src/hooks/*
```

## é–‹ç™¼åŸå‰‡

- å…¨ç¨‹ä½¿ç”¨ä¸­æ–‡æºé€š
- **éµå¾ªå¾Œç«¯æä¾›çš„ API å¥‘ç´„**ï¼ˆè¦‹ä¸Šæ–¹ã€ŒAPI å¥‘ç´„è¦å‰‡ã€ï¼‰
- æ‰€æœ‰é é¢éœ€éŸ¿æ‡‰å¼ï¼ˆæ‰‹æ©Ÿå„ªå…ˆï¼‰
- SEO é é¢ä½¿ç”¨ SSG + ISR
- å•†å®¶é é¢éœ€èªè­‰ä¿è­·
- **åŸ·è¡Œè¼ƒå¤§å‹çš„è¨ˆç•«å‰ï¼Œå…ˆå¯«å¥½å®Œæ•´çš„è¨ˆç•«æ–‡ä»¶**ï¼ˆæ¶‰åŠ 3 å€‹ä»¥ä¸Šæª”æ¡ˆçš„ä¿®æ”¹ï¼Œä¸€å¾‹å…ˆé€²å…¥ Plan Mode å¯«è¨ˆç•«ã€ç¶“å¯©æ ¸å¾Œå†å‹•æ‰‹ï¼‰

---

## å¼·åˆ¶æŸ¥é–±è¦å‰‡ âš¡

åŸ·è¡Œä»»ä½•ä¿®æ”¹å‰ï¼Œ**å¿…é ˆå…ˆè®€å–å°æ‡‰è¨˜æ†¶åº«æª”æ¡ˆ**ï¼š

| ä¿®æ”¹ç¯„åœ | å¿…è®€è¨˜æ†¶åº« |
|----------|------------|
| SEO é é¢ï¼ˆåŸå¸‚ã€æ™¯é»ã€è¡Œç¨‹ï¼‰ | `docs/memory-seo-pages.md` |
| å•†å®¶å¾Œå°ï¼ˆç™»å…¥ã€è¨‚é–±ã€é€€æ¬¾ï¼‰ | `docs/memory-merchant-portal.md` |
| å…±ç”¨å…ƒä»¶ï¼ˆUIã€Layoutï¼‰ | `docs/memory-components.md` |
| API å‹åˆ¥å®šç¾© | å¾Œç«¯ `docs/contracts/WEB.md` |
| éŒ¯èª¤è™•ç† | å¾Œç«¯ `docs/contracts/COMMON.md` |

### åŒæ­¥æŒ‡ä»¤åŸ·è¡Œ

æ”¶åˆ°ã€Œæª¢æŸ¥å¾Œç«¯åŒæ­¥æ¸…å–®ã€æŒ‡ä»¤æ™‚ï¼š

1. è®€å–å¾Œç«¯ `docs/sync-web.md`
2. åŸ·è¡Œæ‰€æœ‰å¾…å®Œæˆä»»å‹™
3. æ›´æ–° `docs/sync-backend.md` å›å ±ç‹€æ…‹
4. Commit + Push

## ç¶²åŸŸ

- **æ­£å¼ç¶²åŸŸ**: `https://mibu-travel.com`
- **Sitemap**: `https://mibu-travel.com/sitemap.xml`

## å°ˆæ¡ˆç‰¹æ€§

| é …ç›® | èªªæ˜ |
|------|------|
| **è¤‡é›œåº¦** | ä¸­ï¼ˆUIã€SEOã€é‡‘æµä¸²æ¥ï¼‰ |
| **ç¨ç«‹æ€§** | ä¾è³´å¾Œç«¯ API |
| **éƒ¨ç½²** | Replit Publish |

å®˜ç¶²ç›¸å°å–®ç´”ï¼Œä¸»è¦æ˜¯ UI å¯¦ä½œå’Œ API ä¸²æ¥ï¼Œç†Ÿæ‚‰ Next.js å³å¯å¿«é€Ÿä¸Šæ‰‹ã€‚

---

## å‹Ÿè³‡ç³»çµ±

ä½æ–¼ `src/features/crowdfund/`ï¼Œç”¨æ–¼ç¾¤çœ¾å‹Ÿè³‡åŠŸèƒ½ã€‚ä¾ç…§ WEB å¥‘ç´„ v1.2.0ã€‚

### é é¢

| è·¯ç”± | ç”¨é€” | æ¸²æŸ“æ–¹å¼ |
|------|------|----------|
| `/crowdfund` | å‹Ÿè³‡æ´»å‹•åˆ—è¡¨ | SSG + ISR |
| `/crowdfund/[id]` | å‹Ÿè³‡æ´»å‹•è©³æƒ… + è´ŠåŠ© | CSR |
| `/crowdfund/my-contributions` | æˆ‘çš„è´ŠåŠ©ç´€éŒ„ | CSR (éœ€èªè­‰) |

### API ç«¯é»

| ç«¯é» | ç”¨é€” | èªè­‰ |
|------|------|------|
| `GET /api/crowdfund/campaigns` | æ´»å‹•åˆ—è¡¨ | å…¬é–‹ |
| `GET /api/crowdfund/campaigns/:id` | æ´»å‹•è©³æƒ… | å…¬é–‹ |
| `POST /api/crowdfund/checkout` | å»ºç«‹ Stripe çµå¸³ | é¸å¡« |
| `GET /api/crowdfund/my-contributions` | æˆ‘çš„è´ŠåŠ© | å¿…å¡« |

---

## æ´»å‹•ç³»çµ±

ä½æ–¼ `src/features/events/`ï¼Œç”¨æ–¼é¦–é æ´»å‹•å€å¡Šé¡¯ç¤ºã€‚ä¾ç…§ WEB å¥‘ç´„ v1.2.0ã€‚

### æ´»å‹•é¡å‹

| é¡å‹ | èªªæ˜ | é¡è‰² |
|------|------|------|
| `announcement` | å…¬å‘Š | è—è‰² |
| `festival` | ç¯€æ…¶ | æ©˜è‰² |
| `limited` | é™æ™‚ | ç´…è‰² |

### API ç«¯é»

| ç«¯é» | ç”¨é€” | èªè­‰ |
|------|------|------|
| `GET /api/events` | æ´»å‹•åˆ—è¡¨ | å…¬é–‹ |

æ”¯æ´ç¯©é¸åƒæ•¸ï¼š`type`ã€`status`ã€`limit`

### ä½¿ç”¨æ–¹å¼

```tsx
import { EventsSection, getActiveEvents } from '@/features/events';

// ç²å–é€²è¡Œä¸­çš„æ´»å‹•
const events = await getActiveEvents(3);

// åœ¨é é¢ä¸­ä½¿ç”¨
<EventsSection events={events} />
```

---

## SEO æ¨¡çµ„æ¶æ§‹

ä½æ–¼ `src/features/seo/`ï¼Œç”¨æ–¼ç¨‹å¼åŒ– SEOã€‚ä¾ç…§ WEB å¥‘ç´„ v1.2.0ã€‚

### ä½¿ç”¨æ–¹å¼

```tsx
import {
  // API ç²å–
  getCities, getCityDetail, getRelatedCities, getCityDistricts,
  getPlaces, getPlaceById, getPlaceBySlug,
  getTrips, getTripsByCity, getTripsByCityAndDistrict, getTripDetail, getRelatedTrips,
  getDistrictDetail,

  // Metadata ç”¢ç”Ÿå™¨
  generateCityMetadata, generatePlaceMetadata, generateTripMetadata,
  generateCityTripsMetadata, generateDistrictTripsMetadata,

  // JSON-LD ç”¢ç”Ÿå™¨
  generateCityJsonLd, generatePlaceJsonLd, generateTripJsonLd,
  generatePlacesListJsonLd, generateCityTripsJsonLd,
  cityBreadcrumb, placeBreadcrumb, tripDetailBreadcrumb,

  // çµ„ä»¶
  Breadcrumb, JsonLdScript, SeoPageHeader,

  // å‹åˆ¥
  type City, type Place, type Trip,
  type CityDetailResponse, type PlaceDetailResponse, type TripDetailResponse,
  type PlacesResponse, type DistrictDetailResponse,
} from '@/features/seo';
```

### SEO API ç«¯é»ï¼ˆä¾ç…§ WEB å¥‘ç´„ v1.2.0ï¼‰

| ç«¯é» | ç”¨é€” | å‡½æ•¸ |
|------|------|------|
| `GET /api/seo/cities` | åŸå¸‚åˆ—è¡¨ | `getCities()` |
| `GET /api/seo/cities/:slug` | åŸå¸‚è©³æƒ…ï¼ˆå«æ™¯é»ï¼‰ | `getCityDetail(slug)` |
| `GET /api/seo/cities/:slug/related` | ç›¸é—œåŸå¸‚ | `getRelatedCities(slug)` |
| `GET /api/seo/cities/:slug/districts` | åŸå¸‚è¡Œæ”¿å€åˆ—è¡¨ | `getCityDistricts(slug)` |
| `GET /api/seo/places` | æ™¯é»åˆ—è¡¨ï¼ˆæ”¯æ´æœå°‹/ç¯©é¸ï¼‰ | `getPlaces(params)` |
| `GET /api/seo/places/:slug?city=xxx` | æ™¯é»è©³æƒ…ï¼ˆä¾ slugï¼‰ | `getPlaceBySlug(slug, city)` |
| `GET /api/seo/places/by-id/:id` | æ™¯é»è©³æƒ…ï¼ˆä¾ IDï¼‰ | `getPlaceById(id)` |
| `GET /api/seo/districts/:citySlug/:districtSlug` | è¡Œæ”¿å€è©³æƒ… | `getDistrictDetail(city, district)` |
| `GET /api/seo/trips` | è¡Œç¨‹åˆ—è¡¨ | `getTrips()` |
| `GET /api/seo/trips?city=xxx` | åŸå¸‚è¡Œç¨‹ | `getTripsByCity(city)` |
| `GET /api/seo/trips?city=xxx&district=xxx` | å€åŸŸè¡Œç¨‹ | `getTripsByCityAndDistrict(city, district)` |
| `GET /api/seo/trips/:id` | è¡Œç¨‹è©³æƒ…ï¼ˆå«æ™¯é»ï¼‰ | `getTripDetail(id)` |
| `GET /api/seo/trips/:id/related` | ç›¸é—œè¡Œç¨‹ | `getRelatedTrips(id)` |

---

## éŒ¯èª¤è™•ç†

ä½¿ç”¨ `src/constants/errorCodes.ts`ï¼ˆä¾ç…§ COMMON å¥‘ç´„ v1.0.0ï¼‰ï¼š

```typescript
import { getErrorMessage, isAuthError, isMerchantError } from '@/constants/errorCodes';

// å–å¾—ä¸­æ–‡éŒ¯èª¤è¨Šæ¯
const message = getErrorMessage('E1007'); // "å¸³è™Ÿé¡å‹ä¸ç¬¦"

// åˆ¤æ–·éŒ¯èª¤é¡å‹
if (isAuthError(code)) { /* èªè­‰éŒ¯èª¤ */ }
if (isMerchantError(code)) { /* å•†å®¶éŒ¯èª¤ */ }
```

### å¸¸ç”¨éŒ¯èª¤ç¢¼

| éŒ¯èª¤ç¢¼ | å¸¸æ•¸ | èªªæ˜ |
|--------|------|------|
| E1001 | AUTH_REQUIRED | è«‹å…ˆç™»å…¥ |
| E1002 | AUTH_TOKEN_EXPIRED | ç™»å…¥å·²éæœŸ |
| E1006 | PENDING_APPROVAL | å¸³è™Ÿå¯©æ ¸ä¸­ |
| E1007 | ROLE_MISMATCH | å¸³è™Ÿé¡å‹ä¸ç¬¦ |
| E4009 | PLACE_LIMIT_REACHED | å·²é”æ™¯é»æ•¸é‡ä¸Šé™ |
| E7001 | PAYMENT_FAILED | ä»˜æ¬¾å¤±æ•— |
| E7002 | SUBSCRIPTION_EXPIRED | è¨‚é–±å·²éæœŸ |

---

## å¸¸è¦‹ä»»å‹™èˆ‡æµç¨‹

### ä»»å‹™é¡å‹

| ä»»å‹™ | é »ç‡ | èªªæ˜ |
|------|------|------|
| ä¸²æ¥å¾Œç«¯ API | é«˜ | ä¾ç…§å¥‘ç´„æ–°å¢/æ›´æ–° API å‘¼å« |
| æ–°å¢é é¢ | ä¸­ | åœ¨ `app/` å»ºç«‹æ–°è·¯ç”± |
| åŒæ­¥å¾Œç«¯å¥‘ç´„ | ä¸­ | åŸ·è¡Œã€Œæª¢æŸ¥å¾Œç«¯åŒæ­¥æ¸…å–®ã€ |
| ä¿®å¾© bug | ä¸­ | è™•ç†éŒ¯èª¤ã€UI å•é¡Œ |
| æ›´æ–° UI å…ƒä»¶ | ä½ | ä¿®æ”¹ `src/components/` |

### æ¨™æº–æµç¨‹

**ä¸²æ¥ API**ï¼š
1. è®€å–å¾Œç«¯å¥‘ç´„ç¢ºèªç«¯é»æ ¼å¼
2. åœ¨ `src/features/*/api/` æ–°å¢å‡½æ•¸
3. åœ¨ `src/features/*/types/` æ–°å¢å‹åˆ¥
4. åœ¨é é¢ä¸­ä½¿ç”¨

**æ–°å¢é é¢**ï¼š
1. è®€å–å°æ‡‰è¨˜æ†¶åº«ï¼ˆSEO/å•†å®¶ï¼‰
2. åœ¨ `app/` å»ºç«‹è³‡æ–™å¤¾å’Œ `page.tsx`
3. æ±ºå®šæ¸²æŸ“æ–¹å¼ï¼ˆSSG/CSRï¼‰
4. å¦‚éœ€èªè­‰ï¼ŒåŒ…è£¹ `AuthGuard`

**åŒæ­¥å¾Œç«¯å¥‘ç´„**ï¼š
1. è®€å–å¾Œç«¯ `docs/sync-web.md`
2. åŸ·è¡Œæ‰€æœ‰å¾…å®Œæˆä»»å‹™
3. æ›´æ–° `docs/sync-backend.md`
4. Commit + Push

---

## å“è³ªæ¨™æº–

### é©—æ”¶æ¨™æº–ï¼ˆä»€éº¼å«ã€Œåšå®Œäº†ã€ï¼‰

- [ ] `npm run check` é€šéï¼ˆç„¡ TypeScript éŒ¯èª¤ï¼‰
- [ ] é é¢éŸ¿æ‡‰å¼ï¼ˆæ‰‹æ©Ÿã€å¹³æ¿ã€æ¡Œé¢ï¼‰
- [ ] API å‘¼å«ä¾ç…§å¾Œç«¯å¥‘ç´„
- [ ] å•†å®¶é é¢æœ‰ AuthGuard ä¿è­·
- [ ] SEO é é¢æœ‰æ­£ç¢ºçš„ metadata

### ç¨‹å¼ç¢¼é¢¨æ ¼

| é …ç›® | è¦ç¯„ |
|------|------|
| èªè¨€ | TypeScriptï¼ˆåš´æ ¼æ¨¡å¼ï¼‰ |
| å…ƒä»¶ | å‡½æ•¸å¼å…ƒä»¶ + hooks |
| æ¨£å¼ | Tailwind CSSï¼Œä¸ç”¨ inline style |
| ç‹€æ…‹ | ä¼ºæœå™¨ç‹€æ…‹ç”¨ TanStack Queryï¼Œå®¢æˆ¶ç«¯ç‹€æ…‹ç”¨ Zustand |
| è¡¨å–® | React Hook Form + Zod é©—è­‰ |

### æ¸¬è©¦æ¨™æº–

ç›®å‰å°ˆæ¡ˆ**æ²’æœ‰æ¸¬è©¦æ¡†æ¶**ï¼Œé©—æ”¶ä¾è³´ï¼š
- TypeScript å‹åˆ¥æª¢æŸ¥
- æ‰‹å‹•æ¸¬è©¦é—œéµæµç¨‹

### Commit è¦ç¯„

```
<type>: <ç°¡çŸ­æè¿°>

<è©³ç´°èªªæ˜ï¼ˆé¸å¡«ï¼‰>
```

**type é¡å‹**ï¼š
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¾© bug
- `docs`: æ–‡ä»¶æ›´æ–°
- `refactor`: é‡æ§‹ï¼ˆä¸æ”¹åŠŸèƒ½ï¼‰
- `style`: æ¨£å¼èª¿æ•´
- `chore`: é›œé …ï¼ˆä¾è³´æ›´æ–°ç­‰ï¼‰

**ç¯„ä¾‹**ï¼š
```
feat: æ–°å¢å•†å®¶å„ªæƒ åˆ¸ç®¡ç†é é¢

- æ–°å¢ /merchant/coupons è·¯ç”±
- ä¸²æ¥ GET/POST/DELETE coupon API
```

---

## çµæŸå‰æª¢æŸ¥æ¸…å–®

æ¯æ¬¡ä»»å‹™å®Œæˆå‰ï¼Œç¢ºèªä»¥ä¸‹é …ç›®ï¼š

### å¿…æª¢é …ç›®

- [ ] `npm run check` é€šé
- [ ] æ²’æœ‰ console.log æ®˜ç•™
- [ ] æ²’æœ‰ç¡¬ç·¨ç¢¼çš„æ¸¬è©¦è³‡æ–™
- [ ] æ•æ„Ÿè³‡è¨Šæ²’æœ‰é€²å…¥ git

### ä¾ä»»å‹™é¡å‹

**å¦‚æœä¿®æ”¹äº† API å‘¼å«**ï¼š
- [ ] å‹åˆ¥èˆ‡å¾Œç«¯å¥‘ç´„ä¸€è‡´
- [ ] éŒ¯èª¤è™•ç†å®Œæ•´

**å¦‚æœæ–°å¢äº†é é¢**ï¼š
- [ ] æ›´æ–° CLAUDE.md å°ˆæ¡ˆçµæ§‹ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰
- [ ] SEO é é¢æœ‰ metadata
- [ ] å•†å®¶é é¢æœ‰ AuthGuard

**å¦‚æœæ˜¯åŒæ­¥ä»»å‹™**ï¼š
- [ ] æ›´æ–° `docs/sync-backend.md` å›å ±ç‹€æ…‹
- [ ] Commit è¨Šæ¯åŒ…å«ä»»å‹™ç·¨è™Ÿ

---

## å°ˆæ¡ˆèªçŸ¥ç²å–æ–¹æ³•

æ–°å°è©±é–‹å§‹æ™‚ï¼ŒClaude æ‡‰é€éä»¥ä¸‹æ­¥é©Ÿå¿«é€Ÿå»ºç«‹å° Mibu å°ˆæ¡ˆçš„èªçŸ¥ï¼š

### 1. è®€å–æ ¸å¿ƒæ–‡ä»¶ï¼ˆå¿…åšï¼‰

| æ–‡ä»¶ | ç›®çš„ |
|------|------|
| `CLAUDE.md`ï¼ˆæœ¬æ–‡ä»¶ï¼‰ | å°ˆæ¡ˆå…¨è²Œã€è¦ç¯„ã€è·¯ç”±è¡¨ |
| `docs/memory-seo-pages.md` | SEO é é¢çš„å¯¦ä½œç‹€æ…‹ |
| `docs/memory-merchant-portal.md` | å•†å®¶åŠŸèƒ½çš„å¯¦ä½œç‹€æ…‹ |
| `docs/memory-components.md` | å…±ç”¨å…ƒä»¶çš„ä½¿ç”¨æ–¹å¼ |

### 2. äº†è§£ä¸‰ç«¯æ¶æ§‹

- **å¾Œç«¯ï¼ˆMIBU_REPLITï¼‰**ï¼šAPI + è³‡æ–™åº« + å¥‘ç´„åˆ¶å®š
- **Appï¼ˆmibu-appï¼‰**ï¼šæ‰­è›‹æ ¸å¿ƒã€è¡Œç¨‹è¦åŠƒã€æ”¶è—
- **å®˜ç¶²ï¼ˆMibu-Pagesï¼Œæœ¬å°ˆæ¡ˆï¼‰**ï¼šSEOã€å•†å®¶è¨‚é–±ã€å‹Ÿè³‡

### 3. äº†è§£ç”¢å“å®šä½

Mibu æ˜¯**æ—…éŠæ‰­è›‹ App**ï¼šç”¨æˆ¶é€éæ‰­è›‹æ©Ÿåˆ¶éš¨æ©Ÿç™¼ç¾æ—…éŠæ™¯é»ã€‚å®˜ç¶²è² è²¬ï¼š
- è®“ Google/AI çˆ¬èŸ²æ‰¾åˆ° Mibu çš„å…§å®¹ï¼ˆç¨‹å¼åŒ– SEOï¼‰
- å•†å®¶è·¨å¹³å°è¨‚é–±ï¼ˆiOS è¦å®šå¿…é ˆåœ¨å®˜ç¶²å®Œæˆï¼‰
- ç¾¤çœ¾å‹Ÿè³‡é–‹æ‹“æ–°åœ‹å®¶

### 4. æŸ¥çœ‹å¾Œç«¯å¥‘ç´„ï¼ˆéœ€è¦æ™‚ï¼‰

å¦‚æœä»»å‹™æ¶‰åŠ API ä¸²æ¥ï¼Œè®€å–å¾Œç«¯ `docs/contracts/WEB.md` å’Œ `COMMON.md`ã€‚

---

## SEO æ¼”é€²æµç¨‹ï¼ˆSkillï¼šã€ŒSEO æ¼”é€²æª¢æŸ¥ã€ï¼‰

æ”¶åˆ°ã€ŒSEO æ¼”é€²æª¢æŸ¥ã€æŒ‡ä»¤æ™‚ï¼ŒåŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿï¼š

### Step 1ï¼šæª¢æŸ¥å¾Œç«¯æ–°ç«¯é»

1. è®€å–å¾Œç«¯ `docs/contracts/WEB.md`
2. æ¯”å° `src/features/seo/api/` ä¸­å·²ä¸²æ¥çš„ç«¯é»
3. æ‰¾å‡ºæ–°å¢ä½†å®˜ç¶²å°šæœªä¸²æ¥çš„ API

### Step 2ï¼šæª¢æŸ¥çµæ§‹åŒ–è³‡æ–™è¦†è“‹ç‡

1. æƒææ‰€æœ‰ `app/` ä¸‹çš„ `page.tsx` æª”æ¡ˆ
2. æª¢æŸ¥æ¯å€‹é é¢æ˜¯å¦æœ‰ `<JsonLdScript>` å…ƒä»¶
3. æª¢æŸ¥æ¯å€‹ SEO é é¢æ˜¯å¦ä½¿ç”¨ SEO æ¨¡çµ„çš„ metadata generator
4. åˆ—å‡ºç¼ºå°‘çµæ§‹åŒ–è³‡æ–™çš„é é¢

### Step 3ï¼šæª¢æŸ¥ JSON-LD ç”¢ç”Ÿå™¨åˆ©ç”¨ç‡

1. åˆ—å‡º `src/features/seo/jsonLd/` ä¸­æ‰€æœ‰ generator
2. æœå°‹å“ªäº› generator å¯¦éš›è¢« `app/` é é¢ä½¿ç”¨
3. å›å ±æœªä½¿ç”¨çš„ generator å’Œå»ºè­°

### Step 4ï¼šæª¢æŸ¥ Schema.org æ–°éœ€æ±‚

1. æ ¹æ“šå¾Œç«¯æ–°åŠŸèƒ½ï¼ˆæ–°å¯¦é«”é¡å‹ï¼‰ï¼Œåˆ¤æ–·æ˜¯å¦éœ€è¦æ–°çš„ JSON-LD generator
2. ä¾‹å¦‚ï¼šå¾Œç«¯æ–°å¢å„ªæƒ åˆ¸ API â†’ å¯èƒ½éœ€è¦ `Offer` schema
3. ä¾‹å¦‚ï¼šå¾Œç«¯æ–°å¢æ´»å‹•è©³æƒ… â†’ å¯èƒ½éœ€è¦ `Event` schema

### Step 5ï¼šè¼¸å‡ºå ±å‘Š

ç”¢å‡ºä»¥ä¸‹è¡¨æ ¼ï¼š

| é …ç›® | ç‹€æ…‹ | å»ºè­° |
|------|------|------|
| æ–° API ç«¯é» | åˆ—å‡º | æ˜¯å¦éœ€è¦æ–° SEO é é¢ |
| ç¼ºå°‘ JSON-LD çš„é é¢ | åˆ—å‡º | éœ€è¦åŠ å…¥å“ªå€‹ generator |
| æœªä½¿ç”¨çš„ generator | åˆ—å‡º | å¯åœ¨å“ªå€‹é é¢ä½¿ç”¨ |
| éœ€è¦æ–°å»ºçš„ generator | åˆ—å‡º | å°æ‡‰çš„ Schema.org é¡å‹ |

### é»ƒé‡‘æ¨™æº–åƒè€ƒ

æ‰€æœ‰ SEO é é¢æ‡‰éµå¾ª `app/trips/[city]/page.tsx` çš„æ¨¡å¼ï¼š
1. å¾ `@/features/seo` import metadata generator + JSON-LD generator + å…ƒä»¶
2. `generateMetadata()` ç”¨ SEO æ¨¡çµ„çš„ generator
3. é é¢é ‚éƒ¨æ”¾ `<JsonLdScript data={...} />`
4. ç”¨ `<SeoPageHeader>` æˆ– `<Breadcrumb>` æä¾›çµæ§‹åŒ–å°è¦½

---

## SEO æ„åœ–çŸ©é™£æ“´å±•ï¼ˆSkillï¼šã€ŒSEO æ„åœ–çŸ©é™£ã€ï¼‰

> **æ ¸å¿ƒæ¦‚å¿µ**ï¼šä¸åªæ˜¯ç”¢é é¢ï¼Œè€Œæ˜¯**ç³»çµ±æ€§è¦†è“‹æ‰€æœ‰æœå°‹èªæ„è®Šé«”**ã€‚
> é€éä¸‰å±¤ç­–ç•¥å»ºç«‹ Mibu åœ¨æ—…éŠæœå°‹ä¸­çš„ä¸»é¡Œæ¬Šå¨ï¼š
> 1. **AI æ„åœ–çŸ©é™£**ï¼šäº¤å‰ã€Œåœ°ç†å¯¦é«” Ã— æ—…éŠæ„åœ– Ã— å…§å®¹æ ¼å¼ã€ç”¢ç”Ÿå…¨è¦†è“‹çš„é•·å°¾é é¢
> 2. **å¾®æƒ…å¢ƒå…§éƒ¨é€£çµ**ï¼šæ¯å€‹é é¢éƒ½æœ‰ç­–ç•¥æ€§çš„ä¸Šä¸‹æ–‡é€£çµï¼Œå°‡æ¬Šé‡å°å‘æ ¸å¿ƒé é¢
> 3. **ä¸»é¡Œæ¬Šå¨é£›è¼ª**ï¼šå¤§é‡é•·å°¾å…§å®¹å †ç–Šä¸»é¡Œæ¬Šå¨ï¼Œè®“ Google èªå®š Mibu æ˜¯æ—…éŠé ˜åŸŸçš„æ¬Šå¨

æ”¶åˆ°ã€ŒSEO æ„åœ–çŸ©é™£ã€æŒ‡ä»¤æ™‚ï¼ŒåŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿï¼š

### Mibu æ„åœ–çŸ©é™£å®šç¾©

çŸ©é™£å…¬å¼ï¼š**[åœ°ç†å¯¦é«” G] Ã— [æ—…éŠæ„åœ– I] Ã— [å…§å®¹æ ¼å¼ F] = é é¢**

| ç¶­åº¦ | ä»£è™Ÿ | ç¾æœ‰å€¼ | å¯æ“´å±•æ–¹å‘ |
|------|------|--------|------------|
| **åœ°ç†å¯¦é«”** | G | åŸå¸‚ã€å€åŸŸã€æ™¯é» | åœ‹å®¶ã€å•†åœˆã€æ·é‹ç«™å‘¨é‚Š |
| **æ—…éŠæ„åœ–** | I | æ™¯é»æ¨è–¦ã€è¡Œç¨‹è¦åŠƒ | ç¾é£Ÿã€äº¤é€šã€ä½å®¿ã€è¦ªå­ã€æƒ…ä¾¶ã€çœéŒ¢ã€å­£ç¯€é™å®š |
| **å…§å®¹æ ¼å¼** | F | åˆ—è¡¨ã€è©³æƒ…é  | æ”»ç•¥ã€æ’åã€æ¯”è¼ƒã€æ‡¶äººåŒ…ã€åœ°åœ–å°è¦½ |

ç¯„ä¾‹çµ„åˆï¼ˆç™½è©±å°±æ˜¯ã€Œç”¨æˆ¶å¯èƒ½æœä»€éº¼ã€ï¼‰ï¼š

```
å°åŒ— Ã— ç¾é£Ÿ Ã— æ’å     â†’ ã€Œå°åŒ—ç¾é£Ÿæ’åã€
æ±äº¬ Ã— è¦ªå­ Ã— è¡Œç¨‹     â†’ ã€Œæ±äº¬è¦ªå­ä¸€æ—¥éŠã€
å¤§é˜ª Ã— äº¤é€š Ã— æ”»ç•¥     â†’ ã€Œå¤§é˜ªäº¤é€šæ”»ç•¥ã€
äº¬éƒ½ Ã— å­£ç¯€ Ã— æ¨è–¦     â†’ ã€Œäº¬éƒ½è³æ«»æ™¯é»æ¨è–¦ã€
é¦–çˆ¾ Ã— çœéŒ¢ Ã— æ‡¶äººåŒ…   â†’ ã€Œé¦–çˆ¾çœéŒ¢æ—…éŠæ‡¶äººåŒ…ã€
æ›¼è°· Ã— å¤œå¸‚ Ã— æ’å     â†’ ã€Œæ›¼è°·å¤œå¸‚æ’åã€
```

### Step 1ï¼šç›¤é»ç¾æœ‰èªæ„è¦†è“‹ç‡

1. è®€å– `src/features/seo/metadata/templates.ts` ä¸­çš„ `TITLE_TEMPLATES` å’Œ `KEYWORDS_TEMPLATES`
2. æƒææ‰€æœ‰ `app/` ä¸‹çš„ SEO é é¢ `page.tsx`ï¼Œæå–æ¯é è¦†è“‹çš„ã€ŒG Ã— I Ã— Fã€çµ„åˆ
3. åˆ—å‡ºç›®å‰è¦†è“‹çš„çµ„åˆï¼š

| ç¾æœ‰é é¢ | åœ°ç† (G) | æ„åœ– (I) | æ ¼å¼ (F) |
|----------|----------|----------|----------|
| `/explore` | æ‰€æœ‰åŸå¸‚ | ç™¼ç¾ç›®çš„åœ° | åˆ—è¡¨ |
| `/city/[slug]` | å–®ä¸€åŸå¸‚ | æ™¯é»æ¨è–¦ | è©³æƒ…+åˆ—è¡¨ |
| `/place/[id]` | å–®ä¸€æ™¯é» | æ™¯é»è³‡è¨Š | è©³æƒ… |
| `/trips` | æ‰€æœ‰åŸå¸‚ | è¡Œç¨‹è¦åŠƒ | åˆ—è¡¨ |
| `/trips/[city]` | å–®ä¸€åŸå¸‚ | è¡Œç¨‹è¦åŠƒ | åˆ—è¡¨ |
| `/trips/[city]/[district]` | å€åŸŸ | è¡Œç¨‹è¦åŠƒ | åˆ—è¡¨ |
| `/trip/[id]` | å–®ä¸€è¡Œç¨‹ | è·¯ç·šè©³æƒ… | è©³æƒ… |

4. ç”¢å‡ºè¦†è“‹ç‡ç¸½çµï¼šç›®å‰è¦†è“‹äº†å¤šå°‘æ¯”ä¾‹çš„æ½›åœ¨æœå°‹æ„åœ–

### Step 2ï¼šåˆ†ææœå°‹æ„åœ–ç¼ºå£

1. æ¯”å°ç¾æœ‰é é¢ vs é«˜åƒ¹å€¼æœå°‹æ„åœ–çš„å·®è·
2. ä¾ç…§å¾Œç«¯ API èƒ½æä¾›çš„è³‡æ–™ï¼Œæ¨™è¨˜**å¯å¯¦ä½œ**å’Œ**éœ€å¾Œç«¯æ”¯æ´**çš„ç¼ºå£ï¼š

| æ„åœ–é¡å‹ | æœå°‹ç¯„ä¾‹ | æ˜¯å¦è¦†è“‹ | å¯ç”¨ API/è³‡æ–™ | å„ªå…ˆç´š |
|----------|----------|----------|--------------|--------|
| åœ°é»ç™¼ç¾ | ã€Œå°åŒ—å¿…å»æ™¯é»ã€ | âœ… | `getCityDetail` | - |
| è¡Œç¨‹è¦åŠƒ | ã€Œå°åŒ—ä¸€æ—¥éŠã€ | âœ… | `getTripsByCity` | - |
| åˆ†é¡ç¯©é¸ | ã€Œå°åŒ—ç¾é£Ÿæ¨è–¦ã€ | âš ï¸ éƒ¨åˆ† | `getPlaces(category=food)` | é«˜ |
| ä¸»é¡Œè¡Œç¨‹ | ã€Œäº¬éƒ½è¦ªå­è¡Œç¨‹ã€ | âŒ | éœ€å¾Œç«¯æ–°å¢ theme ç¯©é¸ | é«˜ |
| å­£ç¯€æ¨è–¦ | ã€Œæ±äº¬æ«»èŠ±æ™¯é»ã€ | âŒ | éœ€å¾Œç«¯æ–°å¢ season æ¨™ç±¤ | ä¸­ |
| äº¤é€šæŒ‡å— | ã€Œå¤§é˜ªäº¤é€šæ”»ç•¥ã€ | âŒ | éœ€å…¨æ–°å…§å®¹é¡å‹ | ä½ |
| é ç®—å°å‘ | ã€Œé¦–çˆ¾çœéŒ¢æ”»ç•¥ã€ | âŒ | éœ€å¾Œç«¯æ–°å¢ priceLevel | ä½ |

3. é‡é»é—œæ³¨ã€Œå¯ç”¨ç¾æœ‰ API ä½†å°šæœªåˆ©ç”¨ã€çš„ç¼ºå£ï¼ˆä¾‹å¦‚ `getPlaces` æ”¯æ´ `category` ç¯©é¸ï¼Œä½†æ²’æœ‰å°æ‡‰çš„ `/city/[slug]/[category]` é é¢ï¼‰

### Step 3ï¼šå¯©è¨ˆå¾®æƒ…å¢ƒå…§éƒ¨é€£çµç¶²çµ¡

> ç™½è©±èªªæ˜ï¼šã€Œæ¯å€‹é é¢æ‡‰è©²åƒä¸€å¼µèœ˜è››ç¶²ï¼Œå¾é•·å°¾æ–‡ç« ï¼ˆå…·é«”æ™¯é»ï¼‰æ²¿è‘—èªæ„ç›¸é—œçš„è·¯å¾‘ï¼ŒæŠŠè®€è€…å’Œ Google çˆ¬èŸ²å°å‘æ ¸å¿ƒé é¢ï¼ˆåŸå¸‚ã€ä¸‹è¼‰ Appï¼‰ã€

1. æƒæç¾æœ‰é é¢ä¸­æ‰€æœ‰ `<Link>` å’Œ `<a>` æ¨™ç±¤ï¼Œç¹ªè£½å…§éƒ¨é€£çµåœ–
2. æª¢æŸ¥é€£çµçµæ§‹æ˜¯å¦å½¢æˆ**ä¸»é¡Œç°‡ï¼ˆTopic Clusterï¼‰**ä¸‰å±¤æ¶æ§‹ï¼š

```
ğŸ  æ¬Šå¨æ ¸å¿ƒé ï¼ˆHubï¼‰           â† /exploreã€/trips
     â†• é›™å‘é€£çµ
ğŸ“„ ä¸­å±¤æ”¯æŸ±é ï¼ˆPillarï¼‰        â† /city/[slug]ã€/trips/[city]
     â†• é›™å‘é€£çµ
ğŸ“ é•·å°¾é é¢ï¼ˆSpokeï¼‰           â† /place/[id]ã€/trip/[id]ã€/trips/[city]/[district]
```

3. æ‰¾å‡ºç¼ºå°‘ä¸Šä¸‹æ–‡é€£çµçš„ã€Œå­¤å³¶é é¢ã€ï¼ˆåªæœ‰ breadcrumb é€£çµï¼Œå…§å®¹ä¸­æ²’æœ‰èªæ„ç›¸é—œçš„é€£çµï¼‰
4. æª¢æŸ¥æ¯å€‹é é¢æ˜¯å¦å…·å‚™ä»¥ä¸‹é€£çµè¦ç´ ï¼š

| é€£çµè¦ç´  | èªªæ˜ | ç¯„ä¾‹ |
|----------|------|------|
| **å‘ä¸Šé€£çµ** | é€£åˆ°æ‰€å±¬çš„ä¸Šå±¤é é¢ | æ™¯é» â†’ åŸå¸‚é  |
| **åŒå±¤é€£çµ** | é€£åˆ°åŒåŸå¸‚/åŒé¡å‹çš„ç›¸é—œé é¢ | æ™¯é» A â†’ ç›¸é—œæ™¯é» B |
| **å‘ä¸‹é€£çµ** | é€£åˆ°æ›´å…·é«”çš„å­é é¢ | åŸå¸‚ â†’ å€åŸŸè¡Œç¨‹ |
| **è·¨ç°‡é€£çµ** | é€£åˆ°ä¸åŒä¸»é¡Œç°‡ä½†èªæ„ç›¸é—œçš„é é¢ | æ™¯é» â†’ åŒ…å«è©²æ™¯é»çš„è¡Œç¨‹ |
| **è½‰æ›é€£çµ** | å¼•å°ä¸‹è¼‰ App çš„ CTA | æ‰€æœ‰é é¢ â†’ App Store |

5. ç”¢å‡ºã€Œé€£çµå¥åº·åº¦ã€å ±å‘Š

### Step 4ï¼šè©•ä¼°ä¸»é¡Œæ¬Šå¨é£›è¼ªç‹€æ…‹

> ç™½è©±èªªæ˜ï¼šã€ŒGoogle ä¸åªçœ‹å–®ä¸€é é¢å¥½ä¸å¥½ï¼Œé‚„çœ‹ä½ é€™å€‹ç¶²ç«™å°æŸå€‹ä¸»é¡Œæ‡‚ä¸æ‡‚ã€‚å¦‚æœ Mibu æœ‰ 50 é å°åŒ—æ—…éŠå…§å®¹ï¼ŒGoogle å°±æœƒèªç‚º Mibu æ˜¯å°åŒ—æ—…éŠçš„å°ˆå®¶ï¼Œæ–°é é¢æ’åä¹Ÿæœƒæ›´å¿«ã€‚ã€

1. çµ±è¨ˆå„ã€Œä¸»é¡Œç°‡ã€çš„é é¢æ•¸é‡å’Œæ¬Šå¨ç­‰ç´šï¼š

| ä¸»é¡Œç°‡ | åŸå¸‚ | é é¢æ•¸é‡ | æ¬Šå¨ç­‰ç´š | å¯ç«¶çˆ­çš„é—œéµå­— |
|--------|------|----------|----------|----------------|
| å°åŒ—æ—…éŠ | taipei | ? | è¨ˆç®—ä¸­ | è¨ˆç®—ä¸­ |
| æ±äº¬æ—…éŠ | tokyo | ? | è¨ˆç®—ä¸­ | è¨ˆç®—ä¸­ |

**æ¬Šå¨ç­‰ç´šåˆ¤å®š**ï¼š
- ğŸŸ¢ **å¼·**ï¼ˆ>30 é ï¼‰ï¼šå¯ç«¶çˆ­çŸ­å°¾é—œéµå­—ï¼Œå¦‚ã€Œå°åŒ—æ—…éŠã€
- ğŸŸ¡ **ä¸­**ï¼ˆ10~30 é ï¼‰ï¼šå¯è¦†è“‹ä¸­å°¾é—œéµå­—ï¼Œå¦‚ã€Œå°åŒ—æ™¯é»æ¨è–¦ã€
- ğŸ”´ **å¼±**ï¼ˆ<10 é ï¼‰ï¼šåƒ…èƒ½è¦†è“‹é•·å°¾é—œéµå­—ï¼Œå¦‚ã€Œå°åŒ—ä¸­æ­£å€ä¸€æ—¥éŠã€

2. è¨ˆç®—æ–¹å¼ï¼š
   - åŸå¸‚é ï¼ˆ1 é ï¼‰+ åŸå¸‚æ™¯é»æ•¸ + åŸå¸‚è¡Œç¨‹æ•¸ + å€åŸŸè¡Œç¨‹æ•¸ = è©²åŸå¸‚ä¸»é¡Œç°‡é é¢ç¸½æ•¸
   - è³‡æ–™ä¾†æºï¼š`getCityDetail` çš„ `placeCount` + `getTripsByCity` çš„è¡Œç¨‹æ•¸
3. è­˜åˆ¥éœ€è¦ã€ŒçŒé‡ã€çš„åŸå¸‚ï¼ˆé é¢æ•¸ä½ä½†å•†æ¥­åƒ¹å€¼é«˜çš„åŸå¸‚ï¼‰
4. å»ºè­°å¾Œç«¯éœ€è¦æä¾›ä»€éº¼æ–°è³‡æ–™ä¾†æ“´å±•å…§å®¹

### Step 5ï¼šç”¢å‡ºè¡Œå‹•è¨ˆç•«

è¼¸å‡ºä»¥ä¸‹å››å¼µè¡¨æ ¼ï¼š

#### 5-1ï¼šæ„åœ–è¦†è“‹ç¼ºå£æ¸…å–®

| ç¼ºå£æè¿° | ç›®æ¨™æœå°‹è© | éœ€è¦çš„ API/è³‡æ–™ | å»ºè­°è·¯ç”± | å„ªå…ˆç´š |
|----------|-----------|----------------|----------|--------|
| ï¼ˆä¾ Step 2 çµæœå¡«å¯«ï¼‰ | | | | |

#### 5-2ï¼šå…§éƒ¨é€£çµæ”¹å–„æ¸…å–®

| é é¢ | å•é¡Œé¡å‹ | å»ºè­°æ–°å¢çš„é€£çµ | é€£çµç›®æ¨™é é¢ |
|------|----------|---------------|-------------|
| ï¼ˆä¾ Step 3 çµæœå¡«å¯«ï¼‰ | å­¤å³¶/ç¼ºå‘ä¸Š/ç¼ºè·¨ç°‡ | | |

#### 5-3ï¼šä¸»é¡Œæ¬Šå¨æ“´å±•è¨ˆç•«

| åŸå¸‚ | ç¾æœ‰é æ•¸ | ç›®æ¨™é æ•¸ | æ¬Šå¨ç­‰ç´šè®ŠåŒ– | éœ€æ–°å¢çš„å…§å®¹é¡å‹ |
|------|----------|----------|-------------|-----------------|
| ï¼ˆä¾ Step 4 çµæœå¡«å¯«ï¼‰ | | | ğŸ”´â†’ğŸŸ¡ | |

#### 5-4ï¼šå¾Œç«¯éœ€æ±‚æ¸…å–®

| éœ€æ±‚ | ç”¨é€”ï¼ˆç™½è©±ï¼‰ | å½±éŸ¿çš„é é¢ | å„ªå…ˆç´š |
|------|-------------|-----------|--------|
| ï¼ˆä¾åˆ†æçµæœå¡«å¯«ï¼‰ | | | |

### åŸ·è¡ŒåŸå‰‡

1. **å…ˆç”¨ç¾æœ‰è³‡æ–™**ï¼šå„ªå…ˆåˆ©ç”¨å¾Œç«¯å·²æœ‰çš„ APIï¼ˆå¦‚ `getPlaces` çš„ `category` ç¯©é¸ï¼‰ï¼Œä¸æ€¥è‘—è¦æ–° API
2. **å¢é‡æ“´å±•**ï¼šæ¯æ¬¡èšç„¦ 1~2 å€‹é«˜åƒ¹å€¼ç¼ºå£ï¼Œä¸è¦ä¸€æ¬¡å…¨åš
3. **é£›è¼ªå„ªå…ˆ**ï¼šå„ªå…ˆå¢åŠ å·²æœ‰ä¸€å®šåŸºç¤çš„åŸå¸‚å…§å®¹ï¼ˆå¾ ğŸŸ¡ æ¨åˆ° ğŸŸ¢ï¼‰ï¼Œè€Œéå¾é›¶é–‹å§‹
4. **é€£çµå…ˆè¡Œ**ï¼šæ”¹å–„å…§éƒ¨é€£çµçš„ ROI é€šå¸¸æ¯”æ–°å¢é é¢é«˜ï¼Œå„ªå…ˆè™•ç†
5. **ä¾ç…§å¥‘ç´„**ï¼šæ‰€æœ‰æ–°é é¢å¿…é ˆéµå¾ªå¾Œç«¯ API å¥‘ç´„ï¼Œä¸è‡ªè¡Œå®šç¾©è³‡æ–™æ ¼å¼
